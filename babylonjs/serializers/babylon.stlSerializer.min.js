!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("babylonjs")):"function"==typeof define&&define.amd?define("babylonjs-serializers",["babylonjs"],t):"object"==typeof exports?exports["babylonjs-serializers"]=t(require("babylonjs")):e.SERIALIZERS=t(e.BABYLON)}("undefined"!=typeof self?self:"undefined"!=typeof global?global:this,(e=>(()=>{"use strict";var t={520:t=>{t.exports=e}},r={};function o(e){var n=r[e];if(void 0!==n)return n.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return(()=>{o.d(n,{default:()=>f});var e={};o.r(e),o.d(e,{STLExport:()=>i});var t={};o.r(t),o.d(t,{STLExport:()=>i});var r=o(520),i=function(){function e(){}return e.CreateSTL=function(e,t,o,n,i,a,s,f){void 0===t&&(t=!0),void 0===o&&(o="stlmesh"),void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===f&&(f=!1);var d=function(e,t,o){var n=[3*e[o],3*e[o+1],3*e[o+2]],i=[new r.Vector3(t[n[0]],t[n[0]+2],t[n[0]+1]),new r.Vector3(t[n[1]],t[n[1]+2],t[n[1]+1]),new r.Vector3(t[n[2]],t[n[2]+2],t[n[2]+1])],a=i[0].subtract(i[1]),s=i[2].subtract(i[1]);return{v:i,n:r.Vector3.Cross(s,a).normalize()}},l=function(e,t,r,o){return t=c(e,t,r.x,o),t=c(e,t,r.y,o),c(e,t,r.z,o)},c=function(e,t,r,o){return e.setFloat32(t,r,o),t+4},u=function(e){if(s){var t=e;e instanceof r.InstancedMesh&&(t=e.sourceMesh);var o=t.getVerticesData(r.VertexBuffer.PositionKind,!0,!0);if(!o)return[];var n=r.Vector3.Zero(),i=void 0;for(i=0;i<o.length;i+=3)r.Vector3.TransformCoordinatesFromFloatsToRef(o[i],o[i+1],o[i+2],e.computeWorldMatrix(!0),n).toArray(o,i);return o}return e.getVerticesData(r.VertexBuffer.PositionKind)||[]};s&&(a=!0);var v="",p=0,b=0;if(n){for(var y=0;y<e.length;y++)p+=(w=(g=e[y]).getIndices())?w.length/3:0;var x=new ArrayBuffer(84+50*p);b+=80,(v=new DataView(x)).setUint32(b,p,i),b+=4}else f||(v="solid stlmesh\r\n");for(y=0;y<e.length;y++){var g=e[y];!n&&f&&(v+="solid "+g.name+"\r\n"),!a&&g instanceof r.Mesh&&g.bakeCurrentTransformIntoVertices();for(var m=u(g),w=g.getIndices()||[],h=0;h<w.length;h+=3){var j=d(w,m,h);n?(b=l(v,b,j.n,i),b=l(v,b,j.v[0],i),b=l(v,b,j.v[1],i),b=l(v,b,j.v[2],i),b+=2):(v+="\tfacet normal "+j.n.x+" "+j.n.y+" "+j.n.z+"\r\n",v+="\t\touter loop\r\n",v+="\t\t\tvertex "+j.v[0].x+" "+j.v[0].y+" "+j.v[0].z+"\r\n",v+="\t\t\tvertex "+j.v[1].x+" "+j.v[1].y+" "+j.v[1].z+"\r\n",v+="\t\t\tvertex "+j.v[2].x+" "+j.v[2].y+" "+j.v[2].z+"\r\n",v+="\t\tendloop\r\n",v+="\tendfacet\r\n")}!n&&f&&(v+="endsolid "+name+"\r\n")}if(n||f||(v+="endsolid stlmesh"),t){var V=document.createElement("a"),S=new Blob([v],{type:"application/octet-stream"});V.href=window.URL.createObjectURL(S),V.download=o+".stl",V.click()}return v},e}(),a=void 0!==o.g?o.g:"undefined"!=typeof window?window:void 0;if(void 0!==a)for(var s in e)a.BABYLON[s]=e[s];const f=t})(),n.default})()));
//# sourceMappingURL=babylon.stlSerializer.min.js.map